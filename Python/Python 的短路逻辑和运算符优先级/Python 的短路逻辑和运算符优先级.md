# Python 的短路逻辑和运算符优先级

## 短路逻辑

1. 短路逻辑的核心思想：从左往右，只有当第一个操作数的值无法确定逻辑运算的结果时，才对第二个操作数进行求值；
2. 短路逻辑只适用于 and 和 or 两个逻辑运算符；

> 表达式从左至右运算，若 or 的左侧逻辑值为 True ，则短路 or 后所有的表达式（不管是 and 还是 or），直接输出 or 左侧表达式 。
>
> 表达式从左至右运算，若 and 的左侧逻辑值为 False ，则短路其后所有 and 表达式，直到有 or 出现，输出 and 左侧表达式到 or 的左侧，参与接下来的逻辑运算。
>
> 若 or 的左侧为 False ，或者 and 的左侧为 True 则不能使用短路逻辑。
> 引用于：[博客园](https://www.cnblogs.com/an9wer/p/5475551.html)。

## 运算符的优先级

运算符的优先级示意图：（数值越大，优先级越高。）
![运算符优先级示意图](http://tg.owo233.eu.org:8080/248/photo-2023-11-09_15-28-14.jpg?hash=bf1476)

一定要注意表达式的优先级，如果将两个优先级不同的表达式放到一起，可能会导致报错，或者其他情况发生。

例如：

```Python
>>> 3 == not 5
  File "<stdin>", line 1
    3 == not 5
             ^^^
SyntaxError: invalid syntax
```

## 拓展：Python 的链式比较

Python 的链式比较是指在同一行中使用多个比较运算符对多个变量进行比较的一种方式。例如：

```python
x > y > z
```

这句话是下面语句的简短形式：

```python
x > y and y > z
```

只有当两个比较都为真时，这个值才为真。在 Python 中，所有比较运算符具有相同的优先级，因此它们从左到右执行。因此，上述语句会先比较 x 与 y，然后比较 y 与 z。只有当 x 小于 y，并且 y 小于等于 z 时，整个表达式的值才为 True。

Python 的链式比较具有以下特点：

* 链式比较的运算符具有相同的优先级，从左到右执行。
* 链式比较的结果是一个布尔值。

以下是一些链式比较的例子：

```python
>>> a = 1
>>> b = 2
>>> c = 3
>>> a < b < c
True
>>> 1 < 2 < 3
True
>>> a == b == c
False
>>> a is b is c
False
```

在 Python 中，链式比较可以用于简化代码，使其更易读。例如，以下两句话的含义相同：

```python
>>> a < b and b < c
True
>>> a < b < c
True
```

链式比较还可以用于比较多个对象的属性。例如，以下语句：

```python
a = {"name": "Alice", "age": 20}
b = {"name": "Bob", "age": 30}

if a["name"] < b["name"]:
    print("a 的 name 属性小于 b 的 name 属性")
```

可以使用链式比较改写为以下语句：

```python
a = {"name": "Alice", "age": 20}
b = {"name": "Bob", "age": 30}

if a["name"] < b["name"]:
    print("a 的 name 属性小于 b 的 name 属性")
```

总而言之，Python 的链式比较是一种简化代码并使其更易读的有效方式，在实际的应用中，应该选择合适的比较方式。

## 实例

### 楼梯谜题

有一个长阶梯，若每步上 2 阶，最后剩 1 阶；若每步上 3 阶，最后剩 2 阶；若每步上 5 阶，最后剩 4 阶；若每步上 6 阶，最后剩 5 阶；只有每步上 7 阶，最后刚好一阶也不剩。求楼梯总数。

#### 思路

设总共有 x 阶楼梯，根据题目可以得出，x % 2 == 1，x % 3 == 2，x % 5 == 4，x % 6 == 5，x % 7 == 0。

根据上面的条件，可以直接使用遍历法确认那个数符合上面的条件，来得到结果。因为每次走 7 步，就可以一个台阶也不剩，所以，最少有 7 个台阶，可以从 7 开始计数。

#### 程序

```Python
x = 7

while True:
    if x % 2 == 1 and x % 3 == 2 and x % 5 == 4 and x % 6 == 5 and x % 7 == 0:
        print('%d 是正确的台阶数。'% x)
        break
    else:
        print('%d 不是正确的台阶数，正在确认下一个数字。'% x)
        x = x + 1
```

> 上面的程序是自己写的，没有设置限制，这在后续的工作中如果碰见 BUG，可能导致无限循环，以至于占用过多的内存。
>
> 下面的程序是引用小甲鱼的程序，仅用于学习，该程序对循环语句做了限制，并且在循环内没有得到结果时，会输出文本告诉用户。

```Python
# 作者：小甲鱼
# 来源：https://fishc.com.cn/thread-150254-1-1.html
# 本代码著作权归作者所有，禁止商业或非商业转载，仅供个人学习使用，违者必究！
# Copyright (c) 2020 fishc.com.cn All rights reserved

# 由于目标值必须是能被7整除，所以我们将测试每个7的倍数
steps = 7
i = 1
FIND = False

while i < 100:
    # 由于测试的都是7的倍数
    # 因此只要同时满足除以2余1、除以3余2、除以5余4、除以6余5，就是最终的结果
    if (steps % 2 == 1) and (steps % 3 == 2) and (steps % 5 == 4) and (steps % 6 == 5):
        FIND = True
        break
    else:
        steps = 7 * (i + 1)
    i = i + 1

if FIND == True:
    print('阶梯数是：', steps)
else:
    print('在程序限定的范围内找不到答案！')
```